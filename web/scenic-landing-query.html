<!DOCTYPE html>
<html>
		
<head>      
	<meta charset='utf-8'>
	<meta name="viewport" content="width=device-width,height=device-height, user-scalable=no" />
	<title>Scenic landing query</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"/>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
	
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
	
	<link href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
	
	<link rel="stylesheet" href="css/scenic-landing-query.css"/>
	<link rel="stylesheet" href="css/flights.css"/>
	
</head>


<body>
	 <!-- loading indicator should be hidden and will only be shown when loading a file -->
	<div id="loading-indicator-background" style="display: none;"></div>
	<div id="loading-indicator" style="display: none;"></div>

	<!---<div id="background" style="margin: 0; width: 100%; height: 100%; ">
		<img src="imgs/scenic_landings_bg.jpg" style="margin-bottom: 0; margin-left: 0; margin-right: 0;"></img>
	</div>-->
	<div style="display: flex; justify-content: center; width: 100%; ">
		<div id="main-container" style="padding-top: 50px; display: flex; flex-wrap: wrap; min-width: 1200px; max-width: 80%; height: 100%;">
			<form class="row mx-0 px-0" style="width: 100%; display: flex; flex-direction: column; flex: space-between;">
				<div class="row query-form-row">
					<div class="query-input-container">
						<label class="query-input-label">Start date</label>
						<input class="query-input" type="date" id="input-start_date">
					</div>

					<div class="query-input-container">
						<label class="query-input-label">End date</label>
						<input class="query-input" type="date" id="input-end_date" value="2019-01-01">
					</div>
					
					<div class="query-input-container">
						<label class="query-input-label">Flight operator</label>
						<select class="query-input" id="select-operator">
							<option value="">Select an operator</option>
						</select>
					</div>

				</div>

				<div class="row query-form-row" style="align-items: center;">
					<!-- checkboxes 
					<div class="row" style="width: 100%">
						<label class="query-input-label">Landing types</label>
					</div>-->
					<div class="query-input-container">
						<label class="query-input-label">Landing types</label>
						<div style="display: flex; align-items: center; justify-content: space-between; background-color: hsl(218, 15%, 95%); height: 50px; padding-left: 10px; padding-right: 10px;">
							<label class="checkmark-container">scenic
								<input class="input-checkbox" type="checkbox" checked="checked" id="checkmark-scenic">
								<span class="checkmark"></span>
							</label>
							<label class="checkmark-container">dropoff
								<input class="input-checkbox" type="checkbox" checked="checked" id="checkmark-dropoff">
								<span class="checkmark"></span>
							</label>
							<label class="checkmark-container">pickup
								<input class="input-checkbox" type="checkbox" checked="checked" id="checkmark-pickup">
								<span class="checkmark"></span>
							</label>
						</div>
					</div>


					<div class="query-input-container">
						<label class="query-input-label">Ticket numbers</label>
						<select class="query-input select2-tag" multiple="multiple" id="select-tickets"></select>
					</div>

					<div class="query-input-container">
						<label class="query-input-label">Landing locations</label>
						<select class="query-input select2-tag" multiple="multiple" id="select-locations"></select>
					</div>

				</div>
				
				<!--submit button-->
				<div class="row query-form-row" style="align-items: center;">
					<div class="query-input-container" style="padding-right: 0; width: 100%;  display: flex; justify-content: center;">
						<input class="query-input" type="submit" style="width: 250px; justify-content: center; border:none;" value="Search flights" onclick="onRunClick(event)">
					</div>
				</div>
			</form>

			<div id='result-table' style="width: 100%; display: flex; overflow-x: hidden; margin-top: 50px; flex-wrap: wrap;">
				<div class="row result-table-header">
					<div class="result-header-cell-container" id="result-header-row">
						<div class="result-table-cell" style="width: 100%;"></div>
					</div>
				</div>
				<div style="overflow-y: auto; width:100%;">
					<div id="place-holder" style="width: 100%; text-align: center; height: 40px; padding: 8px;">Select an operator and click 'Search flights' to show landing fees</div>
					<div class='accordion' id='result-table-body' style="overflow-x: hidden">
						<!--items added dynamically when query is run -->
					</div>
				</div>
			</div>

			<div id="export-button-container" style="margin-top: 50px; width: 100%; display: none; justify-content: center;">
				<button id="export-file-button">Save results</button>
				<!--<input id="file-input" type="file" name="export-save-path" style="display: none;" />-->
			</div>
		</div>
		
	</div>


	<script src="js/scenic-landing-query.js"></script>
	<script src="js/jquery.csv.min.js"></script>
	<script type="text/javascript">
		
		//import * as flights from './js/flights.js';

		//document.getElementById('input-end_date').value = '2019-01-01';
		$(document).ready(() => {
			let today = new Date();
			$('#input-end_date').val(today.getChromeFormattedString(today));
			$('#input-start_date').val(today.addDays(-14).getChromeFormattedString());

			showLoadingIndicator();
			$.when(
				fillSelectOptions('select-operator', "SELECT name, code AS value FROM operators ORDER BY sort_order;", 'scenic_landings'),
				fillSelectOptions('select-locations', "SELECT name, code AS value FROM landing_locations ORDER BY name;", 'scenic_landings')
			).then(hideLoadingIndicator());

			$(window).resize(resizeColumns);

			//var landingQueryResult = {}; //global var to store result for writing CSV

			//$('#file-input').change(onFileInputChange);
			$('#export-file-button').click(onExportDataClick);
			$('.input-checkbox').click(onCheckboxClick);
			$(".select2-tag").select2({
				tokenSeparators: [',', ' ']
			})
			$('#input-start_date, #input-end_date, #select-operator')
				.on('focusin focusout', function() {currentControlVal = $(this).val()})
				.focusout(requerySecondarySelects);
			/*$('#select-tickets, #select-locations').change(function() {
				if (currentControlVal != $(this).val()) {
					requerySecondarySelects()
				}
			});*/

		})

	</script>

</body>


</html>